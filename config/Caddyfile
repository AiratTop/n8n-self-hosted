
# Main n8n service.

${SUBDOMAIN}.${DOMAIN_NAME} {
	# Prevents search engines from indexing this site.
	header X-Robots-Tag "noindex, nofollow"

	# Forwards all traffic to the n8n backend service running on port 5678.
	reverse_proxy n8n-master:5678 {
		# Disables response buffering, which is crucial for Server-Sent Events (SSE) used by n8n.
		flush_interval -1

		# Use only when QUEUE_HEALTH_CHECK_ACTIVE=true
		health_uri /healthz
		health_interval 5s
		health_timeout  5s
		max_fails 2
	}
}